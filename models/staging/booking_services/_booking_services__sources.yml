-version: 2

sources:
  - name: booking_services
    description: Existing Booking Services content in Production
    database: sandpit_sabbott
    schema: landing

    tables:

      - name: LDG_BKG_PLACE_DETAIL

        columns:
          - name: PLACE_ID
            tests:
              - unique
              - not_null

      - name: LDG_BKG_FACILITY_DETAIL

        columns:

          - name: FACILITY_ID     
            tests:
              - unique
              - not_null

      - name: LDG_BKG_UNIT_DETAIL

        columns:
          - name: UNIT_ID
            tests:
              - unique
              - not_null

      - name: LDG_BKG_CUSTOMER_DETAIL

        tests:
          # test multi-col PK
          - dbt_utils.unique_combination_of_columns:
              combination_of_columns:
                - customer_id
                - last_modify_date

        # columns:
        #   - name: CUSTOMER_ID
        #     tests:
        #       - unique
        #       - not_null

      - name: LDG_BKG_PASS_DETAIL

        tests:
          # test multi-col PK
          - dbt_utils.unique_combination_of_columns:
              combination_of_columns:
                - pass_id
                - datetime_updated

      - name: LDG_BKG_UNIT_PRICING

        tests:
          # test multi-col PK
          - dbt_utils.unique_combination_of_columns:
              combination_of_columns:
                - unit_type
                - facility_id
                - unit_price_type
                - pricing_unit
                - datetime_updated

      - name: LDG_BKG_RESERVATION_SUMMARY

        # tests:
        #   # test multi-col PK
        #   - dbt_utils.unique_combination_of_columns:
        #       combination_of_columns:
        #         - reservation_id
        #         - customer_id
        #         - facility_id
        #         - unit_id

      - name: LDG_BKG_RESERVATION_NIGHTLY
      
        tests:
        #   # test multi-col PK
          - dbt_utils.unique_combination_of_columns:
              combination_of_columns:
                - inventory_date
                - reservation_id
                - unit_id
                - age_classification
                - datetime_updated

      - name: LDG_BKG_CAPACITY_NIGHTLY

        tests:
        #   # test multi-col PK
          - dbt_utils.unique_combination_of_columns:
              combination_of_columns:
                - inventory_date
                - facility_id
                - unit_type

      - name: LDG_BKG_RESERVATION_REVENUE

        # columns:
        #   - name: RESERVATION_ID
        #     tests:
        #       - unique
        #       - not_null

        tests:
        #   # test multi-col PK
          - dbt_utils.unique_combination_of_columns:
              combination_of_columns:
                - reservation_id
                - datetime_updated

      